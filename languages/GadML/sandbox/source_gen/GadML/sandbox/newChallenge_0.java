package GadML.sandbox;

/*Generated by MPS */

import com.squareup.okhttp.Credentials;
import com.squareup.okhttp.MediaType;
import java.io.IOException;
import com.google.gson.JsonObject;
import com.google.gson.JsonArray;
import com.squareup.okhttp.RequestBody;
import com.squareup.okhttp.OkHttpClient;
import com.squareup.okhttp.Request;
import com.squareup.okhttp.Response;

public class newChallenge_0 {
  private static String apiChallengeUrl = "https://dev.smartcommunitylab.it/gamification/model/game/";
  private static String credentials = Credentials.basic("long-rovereto", "long_RoVg@me");
  public static final MediaType JSON = MediaType.parse("application/json; charset=utf-8");
  public newChallenge_0() throws IOException {
    run();
  }


  public void run() throws IOException {
    // here we execute a post call to the Game Engine 
    JsonObject challenge = new JsonObject();
    challenge.addProperty("gameId", "idModels2019");
    challenge.addProperty("id", "id1");
    challenge.addProperty("name", "DailyTrips");
    JsonArray variables = new JsonArray();
    variables.add("bonusScore");
    variables.add("bonusPointType");
    variables.add("virtualPrice");
    variables.add("priceWon");
    variables.add("legName");
    challenge.add("variables", variables);
    String challengeJson = challenge.toString();
    RequestBody body = RequestBody.create(JSON, challengeJson);
    // execute POST call to save the gamification Instance 
    doPostChallenge(body, "idModels2019");
    System.out.println("CHALLENGES ADDED");

  }

  public void doPostChallenge(RequestBody body, String gameID) throws IOException {
    OkHttpClient client = new OkHttpClient();
    String urlFinal = apiChallengeUrl + gameID + "/challenge";
    Request request = new Request.Builder().header("Authorization", credentials).url(urlFinal).post(body).build();
    Response response = client.newCall(request).execute();
    System.out.println("POST RESULT: " + response.body().string());
  }


  public static void main(String[] args) throws IOException {
    System.out.println("1. GAME ADAPTATION STARTED");
    new newChallenge_0();

  }
}
